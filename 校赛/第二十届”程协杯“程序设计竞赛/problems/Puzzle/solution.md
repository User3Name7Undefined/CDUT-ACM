## 题解
注意，**类型3**和**类型4**的元素，其连接类型与左侧的相反。这意味着，为了连接这些类型中任意一种元素，链末端应有的连接类型将保持不变。因此，这些类型的元素可以组合成仅由同类型元素构成的独立链。连接这样的链不会改变末端的连接类型。因此，链的**基础**由**类型1**和**类型2**的元素构成。首先，需要构建仅由它们组成的链的基础，然后插入任意一组**类型3**和**类型4**元素的链。

为了使链的基础可行，必须满足 $|c_1 - c_2| \leq 1$。否则，会有多余的元素剩余，答案为 $0$。如果 $c_i \geq c_j$ $($其中 $j = 3 - i$，即**相反类型**的元素，也就是**类型1**与**类型2**，反之亦然$)$，则链的基础可以从**类型 $i$** ($1 \leq i \leq 2)$的元素开始。若 $c_1 = c_2$，则链的基础有**2**种选择，就是**类型1**、**类型2**、**类型1**或**类型2**、**类型1**、**类型2**两种交替，需要分别计数。

为了求出“固定链基础”下的组合数，我们独立计算两个值，再将它们相乘：
- $x_1$ —— 在**类型1**元素之后排列**类型3**元素链的方式数。
- $x_2$ —— 在**类型2**元素之后排列**类型4**元素链的方式数。

 $x_1$ 和 $x_2$ 使用相同的公式计算，该公式也被称为**星与条定理**。将 $n$ 个相同小球看作 “**星**” $($共$n$个$)$，$m$ 个盒子的划分需要 $m - 1$ 个 “**隔板**”。由于允许盒子为空，我们可以把问题转化为：在 $n$ 个星和 $m-1$ 个隔板组成的 $n + m - 1$个位置中，选择 $m - 1$ 个位置放隔板，剩余位置放**星**。总的方案数为 $C_{n+m-1}^{m - 1}$，其中 $C_n^k$ 表示组合数。

要计算最终答案，将 $x_1$ 和 $x_2$的值**相乘**；若 $c_1 = c_2$ ，则将两种所得的乘积**求和**。